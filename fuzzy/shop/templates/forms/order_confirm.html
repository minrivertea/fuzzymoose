{% extends base_template %}
{% load thumbnail i18n %}

{% block pagetitle %}{% trans 'Order (Step 3 of 4) - Confirm Order' %}{% endblock %}

{% block extrajs %}
<script type="text/javascript">

</script>

{% endblock %}

{% block extracss %}
<style type="text/css">

#address p.address {
  margin: 0;   
}

#items tr td:first-child {
  width: 350px;   
}

#items tr td:last-child {
  text-align: right;   
}

#payment {
  margin: 20px 0 0;   
}

</style>

{% endblock %}

{% block content %}

<div class="pure-g-r">
  	
  	<h1 class="pure-u-1-2">Confirm your order</h1>
  	  	
  	<ul id="steps" class="pure-u-1-2">
		<li>
			<a class="completed" href="{% url 'basket' %}">1. Your basket</a>
		</li>
		<li>
			<a class="completed" href="{% url 'order_step_one' %}">2. Your details</a>
		</li>
		<li>
			<a href="" class="selected">3. Confirm and pay</a>
		</li>
	</ul>

</div>
   
<div class="pure-g-r">
				
	<div id="items" class="pure-u-2-3">
		<table>
			{% for thing in order.items.all %}
				  <tr>				
			    	<td class="pure-1-2" valign="top">
			    		<strong>{{ thing.price.product.name }} x {{ thing.quantity }}</strong> 
			    		<span class="small">{{ thing.price.description }}</span>
			    	</td>
			    	<td valign="top">{{ currency.symbol }}{{ thing.get_price|floatformat:"2" }}</td>		    				
				  </tr>
	        {% endfor %}
	        
	        
	    	{% if postage_discount %}
	    	  <tr>
	    	    <td colspan="2"><span class="small"><em>{% blocktrans with currency.symbol as symbol and shopsettings.postage_discount_threshold as ptd %}There is no postage charge, because your order is over {{ symbol }}{{ ptd }}{% endblocktrans %}</em></span></td>
	    	  </tr>
	    	  {% else %}
	    	  <tr>
	    	  	<td>{% trans 'Postage' %}</td>
	    	  	<td>{{ currency.symbol }}{{ shopsettings.postage_price|floatformat:"2" }}</td>		  
	    	  </tr>
	        {% endif %}
	        {% if order.discount %}
	      	  <tr>
	      	  	<td>{% trans 'Discount' %}</td>
	      	  	<td><span class="red">-{{ currency.symbol }}{{ discount_amount|floatformat:"2" }}</span></td>
	      	  </tr>
	      	{% endif %}
			  <tr>
			  	<td><strong>{% trans 'TOTAL' %}</strong></td>
			  	<td><strong>{{ currency.symbol }}{{ total_price|floatformat:"2" }}</strong></td>		  
			  </tr>
		   </table>
	</div>

	<div id="address" class="pure-u-1-3">

        <p class="address">
            {% with order.address as address %}
              <strong>{{ order.shopper.user.first_name }} {{ order.shopper.user.last_name }}</strong>
                {{ order.shopper.user.email }}
                {% include "snippets/address.html" %}
            {% endwith %}
        </p>
  	</div>

    

<form action="" method="POST" class="pure-u-1" id="payment">
  {% csrf_token %}
  <script
    src="https://checkout.stripe.com/v2/checkout.js" class="stripe-button"
    data-key="pk_test_ZNbRkC9EwailVxQXDgJqwg1i"
    data-amount="2000"
    data-name="Demo Site"
    data-description="2 widgets ($20.00)"
    data-image="/128x128.png">
  </script>
</form>



    {# {% include "snippets/paypal_form.html" %} #}
    
</div>

<div id="bottom" class="pure-g-r">

    <div class="info pure-u-1-3">
        <h3>{% trans 'Safe and secure payment' %}</h3>
      	<p>{% trans 'We accept all major credit and debit cards through Paypal' %}</p>
      	<div style="margin: 10px 0 0 0;background-image: url('/static/images/logo16.jpg');background-position: 0px -33px; height: 52px; width: 202px;"></div>
    </div>
    
    <div class="info pure-u-1-3">
        <h3>{% trans 'Problems or questions?' %}</h3>
        <p>{% blocktrans %}We aim to offer first class customer service - if you have ANY problems or questions, <a href="{{ contact_url }}">contact us</a> immediately. We'll respond as quickly as possible, usually within a few hours.{% endblocktrans %}</p>
    </div>


</div>

	
	
	
  </div>
</div>
{% endblock %}
